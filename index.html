<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>
      React Query Demo – Interactive Cache, Stale Time & Garbage Collection
      Visualizer
    </title>
    <meta
      name="title"
      content="React Query Demo – Interactive Cache, Stale Time & Garbage Collection Visualizer"
    />
    <meta
      name="description"
      content="Explore React Query (TanStack Query) caching in action. This interactive demo visualizes stale time, cache time (gcTime), garbage collection, background refetching, and data synchronization — helping you master React Query's data-fetching lifecycle."
    />
    <meta
      name="keywords"
      content="React Query, TanStack Query, React Query demo, React Query cache, React Query stale time, React Query gcTime, React Query garbage collection, useQuery, data fetching React, React Query tutorial, React Query example, React Query visualization, cache invalidation, background refetching, React server state, React data sync"
    />
    <meta name="author" content="Hamed Panjeh" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://react-query.dev/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://react-query.dev/" />
    <meta
      property="og:title"
      content="React Query Demo – Interactive Cache & Data-Fetching Visualizer"
    />
    <meta
      property="og:description"
      content="See how React Query (TanStack Query) manages caching, stale time, gcTime, garbage collection, and background refetching in a live interactive demo."
    />
    <meta property="og:image" content="https://react-query.dev/og-image.png" />
    <meta property="og:site_name" content="React Query Demo" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://react-query.dev/" />
    <meta
      name="twitter:title"
      content="React Query Demo – Interactive Cache & Data-Fetching Visualizer"
    />
    <meta
      name="twitter:description"
      content="See how React Query (TanStack Query) manages caching, stale time, gcTime, garbage collection, and background refetching in a live interactive demo."
    />
    <meta name="twitter:image" content="https://react-query.dev/og-image.png" />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <link rel="apple-touch-icon" href="/vite.svg" />

    <!-- Web App Manifest -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#7c3aed" />

    <!-- Structured Data: WebApplication -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "React Query Demo",
        "url": "https://react-query.dev/",
        "description": "An interactive visualization that makes React Query's caching, stale time, garbage collection, and data-sync behavior easy to grasp at a glance.",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Any",
        "author": {
          "@type": "Person",
          "name": "Hamed Panjeh",
          "url": "https://www.linkedin.com/in/hpwebdeveloper/"
        },
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "keywords": "React Query, TanStack Query, cache demo, data fetching, useQuery, stale time, gcTime, garbage collection"
      }
    </script>

    <!-- Structured Data: FAQPage (helps win rich snippets) -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
          {
            "@type": "Question",
            "name": "What is React Query stale time?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Stale time (staleTime) is the duration data is considered fresh after being fetched. During this window React Query won't refetch the data automatically. Once stale time expires, the data is marked stale and may be refetched on the next trigger (window focus, component mount, etc.)."
            }
          },
          {
            "@type": "Question",
            "name": "What is React Query gcTime (cache time)?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "gcTime (formerly cacheTime) controls how long inactive (unused) query data stays in the cache before being garbage collected. Even after a component unmounts, the cached data remains available for this duration so remounting is instant."
            }
          },
          {
            "@type": "Question",
            "name": "How does React Query garbage collection work?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "When a query has no active observers (no mounted components using it), React Query starts a garbage collection timer equal to gcTime. If the query isn't used again before the timer expires, the cached data is permanently removed from memory."
            }
          },
          {
            "@type": "Question",
            "name": "What is the difference between isLoading and isFetching in React Query?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "isLoading is true only on the very first fetch when there is no cached data. isFetching is true whenever a network request is in flight, including background refetches. This means isFetching can be true while isLoading is false when stale data is being refreshed behind the scenes."
            }
          }
        ]
      }
    </script>

    <!-- Structured Data: HowTo (step-by-step guide for rich snippets) -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Use the React Query Cache Demo",
        "description": "A 10-step interactive guide to understanding React Query's caching lifecycle — from first fetch through stale time, cache sharing, mount/unmount behavior, and garbage collection.",
        "totalTime": "PT5M",
        "tool": [
          { "@type": "HowToTool", "name": "Modern web browser (Chrome, Firefox, Safari, or Edge)" },
          { "@type": "HowToTool", "name": "Browser DevTools console (F12)" }
        ],
        "step": [
          {
            "@type": "HowToStep",
            "position": 1,
            "name": "Select a User",
            "text": "Click one of the three user buttons (User 1, User 2, or User 3). React Query fetches data from the server for the first time. The status shows Loading, then the user card appears and a 30-second stale-time countdown begins."
          },
          {
            "@type": "HowToStep",
            "position": 2,
            "name": "Switch to Another User",
            "text": "Click a different user button. A new API call is made for the new user while the previous user's data remains cached. The garbage-collection countdown starts for the previous user's cache entry."
          },
          {
            "@type": "HowToStep",
            "position": 3,
            "name": "Switch Back to a Previously Fetched User",
            "text": "Click back on a user you already fetched within 30 seconds. The data appears instantly from cache with no network request — the console confirms no API call was made."
          },
          {
            "@type": "HowToStep",
            "position": 4,
            "name": "Wait for Data to Become Stale",
            "text": "Watch the blue stale-time countdown reach 0. The label turns orange and reads STALE. The cached data is still displayed but is now considered outdated by React Query."
          },
          {
            "@type": "HowToStep",
            "position": 5,
            "name": "Show the Child Component (Cache Sharing)",
            "text": "Click the purple Show Child Component button. A child component appears using the same cached data with the same queryKey — no duplicate network request is made."
          },
          {
            "@type": "HowToStep",
            "position": 6,
            "name": "Hide the Child Component",
            "text": "Click the button again to hide the child. The observer count drops but the parent still observes the query, so no garbage-collection countdown starts."
          },
          {
            "@type": "HowToStep",
            "position": 7,
            "name": "Unmount the Component",
            "text": "Click the orange Unmount Component button. The user card disappears and the 60-second garbage-collection countdown begins in the GC countdown panel."
          },
          {
            "@type": "HowToStep",
            "position": 8,
            "name": "Re-mount Before GC Expires",
            "text": "Click Mount Component before the GC countdown reaches 0. The data reappears instantly from cache with no loading spinner, demonstrating gcTime's grace period."
          },
          {
            "@type": "HowToStep",
            "position": 9,
            "name": "Let Garbage Collection Remove the Cache",
            "text": "Unmount and wait the full 60 seconds. The Garbage Collection Monitor logs a removal event, confirming the cache entry has been permanently deleted."
          },
          {
            "@type": "HowToStep",
            "position": 10,
            "name": "Mount After Garbage Collection",
            "text": "Click Mount Component after the GC event. You see the Loading spinner again and a fresh API call in the console — the full fetch-cache-stale-GC lifecycle is complete."
          }
        ]
      }
    </script>
  </head>
  <body>
    <div id="root"></div>

    <!-- Noscript fallback for search-engine crawlers that don't execute JS -->
    <noscript>
      <h1>React Query Demo – Interactive Cache Visualizer</h1>
      <p>
        This interactive demo by Hamed Panjeh visualizes React Query (TanStack
        Query) caching, stale time, gcTime, garbage collection, and background
        refetching to help developers understand data-fetching lifecycle at a
        glance.
      </p>
      <p>
        Features: live cache countdown timers, mount/unmount simulation, user
        data fetching, stale vs fresh indicators, and garbage collection
        monitoring.
      </p>
      <h2>How to Use This React Query Demo</h2>
      <ol>
        <li><strong>Select a User</strong> — Click User 1, 2, or 3 to fetch data. React Query makes a real API call and starts a 30-second stale-time countdown.</li>
        <li><strong>Switch Users</strong> — Click a different user. The previous user's data stays cached while a new fetch occurs.</li>
        <li><strong>Switch Back</strong> — Return to a previously fetched user within 30 seconds. Data loads instantly from cache—no network request.</li>
        <li><strong>Wait for Stale</strong> — After 30 seconds the data becomes stale (orange). React Query will refetch on the next trigger.</li>
        <li><strong>Show Child Component</strong> — Click "Show Child Component" to see cache sharing. Both parent and child use the same cached data.</li>
        <li><strong>Hide Child Component</strong> — Hiding the child reduces the observer count but the cache remains active.</li>
        <li><strong>Unmount</strong> — Click "Unmount Component" to remove the UI. The 60-second garbage-collection countdown begins.</li>
        <li><strong>Re-mount Before GC</strong> — Mount again before 60 seconds. Cached data appears instantly.</li>
        <li><strong>Wait for Garbage Collection</strong> — Let the GC timer expire. The cache is permanently removed.</li>
        <li><strong>Mount After GC</strong> — Mount again after GC. A fresh API call is made—completing the full lifecycle.</li>
      </ol>
      <p>
        Visit <a href="https://react-query.dev/">react-query.dev</a> with
        JavaScript enabled to explore the full interactive experience.
      </p>
    </noscript>

    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
